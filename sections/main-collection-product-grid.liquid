<script src="{{ 'collection.js' | asset_url }}" defer="defer"></script>
{{ 'collection.css' | asset_url | stylesheet_tag }}

{{ 'component-facets.css' | asset_url | stylesheet_tag }}
<script src="{{ 'facets.js' | asset_url }}" defer="defer"></script>

<main class="collection-section">
  <div class="collection-page__container">
    <div class="page-top">
      {% include 'breadcrumbs' %}

      <!-- Top content start -->

      <div class="page-top-content">
        <div class="category-title">
          <h1>{{ collection.title }}</h1>
        </div>
        <div id="above-the-fold">
          <div class="show-paragraph">
            <p>{{ collection.description }}</p>
          </div>

          <div class="expandable">
            <div class="atf-links" style="display: flex;">
              {% for tag in collection.all_tags %}
                {% if tag contains 'swatchcolour_' %}
                  <p>
                    <a
                      href="{{ tag | handleize | prepend:'/' | within: collection }}"
                      title="{{ tag | remove: 'swatchcolour_' | replace: "-", "/" | capitalize}}"
                    >
                      {{- tag | remove: 'swatchcolour_' | replace: '-', '/' | capitalize -}}
                    </a>
                  </p>
                {% endif %}
              {% endfor %}
            </div>
          </div>
          {% if collection.description != blank %}
            <span id="view-more-atf" class="view-more">Read more</span>
          {% endif %}  
        </div>
      </div>

      <!-- Top content end -->

      <!-- collection product layout start -->
      {%- paginate collection.products by section.settings.per_page_product -%}
        <div class="collection-grid">
          <div class="filter-sidebar">
            <div class="filter-title">
              <h3>Filters</h3>
              <button type="button" class="drawer__close-button">
                <svg aria-hidden="true" focusable="false" role="presentation" viewBox="0 0 64 64">
                  <path d="M19 17.61l27.12 27.13m0-27.12L19 44.74"></path>
                </svg>
              </button>
            </div>
            <div class="filter-content">
              {% render 'collection-filter' %}
            </div>
          </div>

          <div class="collection-grid__wrapper">
            <div class="toolbar-options-wrapper">
              <div class="grid-display-type">
                <a href="javascript:void(0)" class="display__4__items display__active" data-view="grid">
                  <svg width="21" height="24" viewBox="0 0 21 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="0.25" y="0.75" width="8.5" height="9.5" stroke="black" stroke-width="0.5"></rect>
                    <rect x="0.25" y="13.75" width="8.5" height="9.5" stroke="black" stroke-width="0.5"></rect>
                    <rect x="12.25" y="0.75" width="8.5" height="9.5" stroke="black" stroke-width="0.5"></rect>
                    <rect x="12.25" y="13.75" width="8.5" height="9.5" stroke="black" stroke-width="0.5"></rect>
                  </svg>
                </a>
                <a href="javascript:void(0)" class="display__3__items" data-view="list">
                  <svg width="33" height="23" viewBox="0 0 33 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="0.25" y="0.25" width="8.5" height="22.5" stroke="black" stroke-width="0.5"></rect>
                    <rect x="12.25" y="0.25" width="8.5" height="22.5" stroke="black" stroke-width="0.5"></rect>
                    <rect x="24.25" y="0.25" width="8.5" height="22.5" stroke="black" stroke-width="0.5"></rect>
                  </svg>
                </a>
              </div>

              <div class="toolbar-options">
                <div class="sort-options">
                  <a class="filter-mobile-title" href="javascript:void(0)">
                    <span>Filters</span>
                    <svg
                      aria-hidden="true"
                      focusable="false"
                      role="presentation"
                      class="icon icon-chevron-right"
                      viewBox="0 0 284.49 498.98"
                    >
                      <path d="M35 498.98a35 35 0 0 1-24.75-59.75l189.74-189.74L10.25 59.75a35.002 35.002 0 0 1 49.5-49.5l214.49 214.49a35 35 0 0 1 0 49.5L59.75 488.73A34.89 34.89 0 0 1 35 498.98z"></path>
                    </svg>
                  </a>                 
                  <div class="sort-options-container">
                    <div class="sort-options-dropdown sort-options-dropdown-bottom" id="sort-options-dropdown-bottom">
                      <a
                        href="javascript:void(0)"
                        id="sort-options-dropdown-title-bottom"
                        onclick="sortDropdownBottom()"
                        class="sort-options-dropdown-title sort-options-dropdown-title-bottom"
                      >
                        <span> popular</span>
                        <svg
                          aria-hidden="true"
                          focusable="false"
                          role="presentation"
                          class="icon icon-chevron-right"
                          viewBox="0 0 284.49 498.98"
                        >
                          <path d="M35 498.98a35 35 0 0 1-24.75-59.75l189.74-189.74L10.25 59.75a35.002 35.002 0 0 1 49.5-49.5l214.49 214.49a35 35 0 0 1 0 49.5L59.75 488.73A34.89 34.89 0 0 1 35 498.98z"></path>
                        </svg>
                      </a>
                      <div class="sort-options-dropdown-content">
                        <div class="sort-title">
                          <span>sort</span>
                          <svg
                            aria-hidden="true"
                            focusable="false"
                            role="presentation"
                            class="icon icon-chevron-right"
                            viewBox="0 0 284.49 498.98"
                          >
                            <path d="M35 498.98a35 35 0 0 1-24.75-59.75l189.74-189.74L10.25 59.75a35.002 35.002 0 0 1 49.5-49.5l214.49 214.49a35 35 0 0 1 0 49.5L59.75 488.73A34.89 34.89 0 0 1 35 498.98z"></path>
                          </svg>
                          <button type="button" class="drawer__close-button">
                            <svg aria-hidden="true" focusable="false" role="presentation" viewBox="0 0 64 64">
                              <path d="M19 17.61l27.12 27.13m0-27.12L19 44.74"></path>
                            </svg>
                          </button>
                        </div>                       
                        <a
                          class="shadowSort__option  active"
                          href="?sort_by=default"
                          data-value="default"
                          title="Popular"
                          ><span>Popular</span></a
                        >
                        <a
                          class="shadowSort__option"
                          href="?sort_by=price-ascending"
                          data-value="price-ascending"
                          title="Price, low to high"
                          ><span>Price, low to high</span></a
                        >
                        <a
                          class="shadowSort__option"
                          href="?sort_by=price-descending"
                          data-value="price-descending"
                          title="Price, high to low"
                          ><span>Price, high to low</span></a
                        >
                        <a
                          class="shadowSort__option"
                          href="?sort_by=created-ascending"
                          data-value="created-ascending"
                          title="Date, old to new"
                          ><span>Date, old to new</span></a
                        >
                        <a
                          class="shadowSort__option"
                          href="?sort_by=created-descending"
                          data-value="created-descending"
                          title="Date, new to old"
                          ><span>Date, new to old</span></a
                        >
                      </div>
                    </div>
                  </div>
                </div>

                <div class="selected-filters-options selected-filters-options-mobile" style="display:none;">
                  <form class="filter-form " id="collection-sidebar-filter">
                    <div class="active-filters selected-filters-options">
                      {%- for filter in collection.filters -%}
                        {%- if filter.type == 'price_range' -%}
                          {%- if filter.min_value.value != null or filter.max_value.value != null -%}
                            <a
                              class="active-filters__remove-filter selected-option-item"
                              href="{{ filter.url_to_remove }}"
                            >
                              {%- assign min_value = filter.min_value.value | default: 0 -%}
                              {%- assign max_value = filter.max_value.value | default: filter.range_max -%}
                              {{ min_value | money }} - {{ max_value | money }} X
                            </a>
                          {%- endif -%}
                        {%- else -%}
                          {%- for filter_value in filter.active_values -%}
                            <a
                              class="active-filters__remove-filter selected-option-item "
                              href="{{ filter_value.url_to_remove }}"
                            >
                              {% if filter.label == 'Colour' %}
                                <span
                                  class="color-box"
                                  style="border: 1px solid #e8e8e1;height: 16px;width: 16px;display: inline-block;background-color:{{- filter_value.label -}}; background-image:url({{  filter_value.label |  replace: " ", "-" | append: '.png' | file_img_url }});"
                                ></span>
                              {% else %}
                                {{ filter.label }}: {{ filter_value.label -}}
                              {%- endif %}
                              X
                            </a>
                          {%- endfor -%}
                        {%- endif -%}
                      {%- endfor -%}
                      {%- for filter in collection.filters -%}
                        {% if filter.active_values.size > 0 %}
                          {% break %}
                        {% endif %}
                      {%- endfor -%}
                      <a
                        href="{{ collection.url }}?sort_by={{ collection.sort_by }}"
                        class="active-filters__clear clear-all-btn"
                        >Clear all</a
                      >
                    </div>
                  </form>                  
                </div>

                {%- if paginate.pages > 1 -%}
                  {% render 'pagination', paginate: paginate, anchor: '' %}
                {%- endif -%}
              </div>
            </div>
            <img src="https://cdn.shopify.com/s/files/1/0282/8166/7663/files/ZKZg.gif?v=1690891203" id="collection-loader">
            <div class="collection__grid">
              {%- for product in collection.products -%}
                <div class="product__content" data-product-handle="{{ product.handle }}">
                  <div class="product-collection-image__wrapper">
                    <div class="wishlist-btn">
                      <a
                        href="javascript:void(0)"
                        class="kp-wishlist_btn {{ template.name }}"
                        data-product-handle="{{product.handle}}"
                        title="wishlist"
                      >
                        <svg
                          width="24"
                          height="24"
                          xmlns="http://www.w3.org/2000/svg"
                          fill-rule="evenodd"
                          clip-rule="evenodd"
                        >
                          <path d="M12 21.593c-5.63-5.539-11-10.297-11-14.402 0-3.791 3.068-5.191 5.281-5.191 1.312 0 4.151.501 5.719 4.457 1.59-3.968 4.464-4.447 5.726-4.447 2.54 0 5.274 1.621 5.274 5.181 0 4.069-5.136 8.625-11 14.402m5.726-20.583c-2.203 0-4.446 1.042-5.726 3.238-1.285-2.206-3.522-3.248-5.719-3.248-3.183 0-6.281 2.187-6.281 6.191 0 4.661 5.571 9.429 12 15.809 6.43-6.38 12-11.148 12-15.809 0-4.011-3.095-6.181-6.274-6.181"/>
                        </svg>
                      </a>
                    </div>

                    <div class="product-collection-image__carousel">
                      <div class="collection-product-slider">
                        {% for media in product.media %}
                          <div class="{{ media.alt | handleize }}">
                            <a href="{{ product.url }}" class="product--url">
                              <img src="{{ media |img_url: '' }}" width="800" height="1200" alt="{{ media.alt }}">
                            </a>
                          </div>
                        {% endfor %}
                      </div>

                      <div class="attribute-options inside">
                        {%- unless product.has_only_default_variant -%}
                          {% for option in product.options_with_values %}
                            <div class="attribute-options__wrapper {{ option.name | handleize }}{% for product in collection.products %}{% for tag in product.tags %}{% if tag contains 'diff_size' %}diff_size{% endif %}{% endfor %}{% endfor %}">
                              {% for value in option.values %}
                                {% assign radio_id = 'option-'
                                  | append: option_name
                                  | append: '-'
                                  | append: value
                                  | handleize
                                %}

                                {%- for variant in product.variants -%}
                                  {%- if variant.title contains value -%}
                                    {%- assign variantImgSrc = variant.image.src
                                      | img_url: '20x20', scale: 3, crop: 'center'
                                    -%}                                   
                                    {%- break -%}
                                  {%- endif -%}
                                {%- endfor -%}
                                <a
                                  href="javascript:void(0)"
                                  data-option-value="{{ value }}"
                                  data-product-handle="{{ product.handle }}"
                                >
                                  <label for="{{ radio_id }}" class="color-swatch-list"
                                    {% if option.name == 'color' or option.name == 'Color' or option.name == 'Colour' or option.name == 'colour' %}
                                    style="background-color: {{ value }}; background-image:url({{ value |  replace: " ", "-" | append: '.png' | file_img_url }});height: 100%;width: 100%;"
                                    {% endif %}
                                >
                                    {% if option.name == 'Colour' %}
                                      {% comment %}
                                      <img src="{{ variantImgSrc }}">
                                       {% endcomment %}
                                    {% else %}
                                      {{ value }}
                                    {% endif %}
                                  </label>
                                </a>
                              {% endfor %}
                            </div>
                          {% endfor %}
                        {% endunless %}
                      </div>

                      <div class="product-actions-container">
                        <div class="added-to-cart-notice">added to bag</div>
                        <button class="quick-add-button" type="button" title="quick add">QUICK ADD +</button>
                      </div>
                    </div>
                  </div>

                  <div class="product--link">
                    <a href="{{ product.url }}">
                      <div class="product__title-wrapper">
                        <h3 class="product__title">{{ product.title }}</h3>
                      </div>
                      <div class="product__price-wrapper">
                          {% if product.compare_at_price %}
                            <div class="product_sale_price">
                              <div class="product_discount_price">
                                <span>{{ product.price | money_with_currency }}</span>
                                <del>{{ product.compare_at_price | money_with_currency }}</del>
                              </div>
                              <div class="product_save_price">
                                <span class="amount_discount">{{- product.compare_at_price | minus: product.price | money_with_currency -}}</span>
                                <span class="percent_discount">({{- product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price -}} % OFF)</span>
                              </div>
                            </div>
                          {% else %}
                          <div class="product_regular_price">{{ product.price | money_with_currency }}</div>
                          {% endif %}
                      </div>
                      <div class="product__brand">{{ product.vendor }}</div>
                    </a>
                    <!-- <span class="product__atc">{% render 'icon-cart-empty' %}</span> -->
                  </div>
                <div class="attribute-options outside">
                        {%- unless product.has_only_default_variant -%}
                          {% for option in product.options_with_values %}
                             {% if option.name == 'Colour' %}
                            <div class="attribute-options__wrapper {{ option.name | handleize }}{% for product in collection.products %}{% for tag in product.tags %}{% if tag contains 'diff_size' %}diff_size{% endif %}{% endfor %}{% endfor %}">
                              {% for value in option.values %}
                                {% assign radio_id = 'option-'
                                  | append: option_name
                                  | append: '-'
                                  | append: value
                                  | handleize
                                %}

                                {%- for variant in product.variants -%}
                                  {%- if variant.title contains value -%}
                                    {%- assign variantImgSrc = variant.image.src
                                      | img_url: '20x20', scale: 3, crop: 'center'
                                    -%}
                                    {%- break -%}
                                  {%- endif -%}
                                {%- endfor -%}
                                <a
                                  href="javascript:void(0)"
                                  data-option-value="{{ value }}"
                                  data-product-handle="{{ product.handle }}"
                                >
                                  <label for="{{ radio_id }}" class="color-swatch-list"
                                {% if option.name == 'color' or option.name == 'Color' or option.name == 'Colour' or option.name == 'colour' %}
                                    style="background-color: {{ value }}; background-image:url({{ value |  replace: " ", "-" | append: '.png' | file_img_url }});height: 100%;width: 100%;"
                                    {% endif %} >
                                {% comment %}
                                      <img src="{{ variantImgSrc }}">
                                       {% endcomment %}                                 
                                  </label>
                                </a>
                              {% endfor %}
                            </div>                               
                            {% endif %}
                          {% endfor %}
                        {% endunless %}
                      </div>
                </div>
              {% endfor %}
            </div>

            <div class="toolbar-options-wrapper">
              <div class="toolbar-options">
                <div class="sort-options">
                  <a class="filter-mobile-title" href="javascript:void(0)">
                    <span>Filters</span>
                    <svg
                      aria-hidden="true"
                      focusable="false"
                      role="presentation"
                      class="icon icon-chevron-right"
                      viewBox="0 0 284.49 498.98"
                    >
                      <path d="M35 498.98a35 35 0 0 1-24.75-59.75l189.74-189.74L10.25 59.75a35.002 35.002 0 0 1 49.5-49.5l214.49 214.49a35 35 0 0 1 0 49.5L59.75 488.73A34.89 34.89 0 0 1 35 498.98z"></path>
                    </svg>
                  </a>                 
                  <div class="sort-options-container">
                    <div class="sort-options-dropdown sort-options-dropdown-bottom" id="sort-options-dropdown-bottom">
                      <a
                        href="javascript:void(0)"
                        id="sort-options-dropdown-title-bottom"
                        onclick="sortDropdownBottom()"
                        class="sort-options-dropdown-title sort-options-dropdown-title-bottom"
                      >
                        <span> popular</span>
                        <svg
                          aria-hidden="true"
                          focusable="false"
                          role="presentation"
                          class="icon icon-chevron-right"
                          viewBox="0 0 284.49 498.98"
                        >
                          <path d="M35 498.98a35 35 0 0 1-24.75-59.75l189.74-189.74L10.25 59.75a35.002 35.002 0 0 1 49.5-49.5l214.49 214.49a35 35 0 0 1 0 49.5L59.75 488.73A34.89 34.89 0 0 1 35 498.98z"></path>
                        </svg>
                      </a>
                      <div class="sort-options-dropdown-content">
                        <div class="sort-title">
                          <span>sort</span>
                          <svg
                            aria-hidden="true"
                            focusable="false"
                            role="presentation"
                            class="icon icon-chevron-right"
                            viewBox="0 0 284.49 498.98"
                          >
                            <path d="M35 498.98a35 35 0 0 1-24.75-59.75l189.74-189.74L10.25 59.75a35.002 35.002 0 0 1 49.5-49.5l214.49 214.49a35 35 0 0 1 0 49.5L59.75 488.73A34.89 34.89 0 0 1 35 498.98z"></path>
                          </svg>
                          <button type="button" class="drawer__close-button">
                            <svg aria-hidden="true" focusable="false" role="presentation" viewBox="0 0 64 64">
                              <path d="M19 17.61l27.12 27.13m0-27.12L19 44.74"></path>
                            </svg>
                          </button>
                        </div>                       
                        <a
                          class="shadowSort__option  active"
                          href="?sort_by=default"
                          data-value="default"
                          title="Popular"
                          ><span>Popular</span></a
                        >
                        <a
                          class="shadowSort__option"
                          href="?sort_by=price-ascending"
                          data-value="price-ascending"
                          title="Price, low to high"
                          ><span>Price, low to high</span></a
                        >
                        <a
                          class="shadowSort__option"
                          href="?sort_by=price-descending"
                          data-value="price-descending"
                          title="Price, high to low"
                          ><span>Price, high to low</span></a
                        >
                        <a
                          class="shadowSort__option"
                          href="?sort_by=created-ascending"
                          data-value="created-ascending"
                          title="Date, old to new"
                          ><span>Date, old to new</span></a
                        >
                        <a
                          class="shadowSort__option"
                          href="?sort_by=created-descending"
                          data-value="created-descending"
                          title="Date, new to old"
                          ><span>Date, new to old</span></a
                        >
                      </div>
                    </div>
                  </div>
                </div>

                {%- if paginate.pages > 1 -%}
                  {% render 'pagination', paginate: paginate, anchor: '' %}
                {%- endif -%}
              </div>
            </div>
          </div>
        </div>
        <!-- collection product layout end -->
      {% endpaginate %}
    </div>
  </div>
</main>
<script>
           $(document).ready(function(){
           $(function() {

               if ( document.location.href.indexOf('sort_by=default') > -1 ) {

                  $(".shadowSort__option[data-value='default']").addClass("active");
                 $("#sort-options-dropdown-title-bottom>span").text("popular");
               }
               if ( document.location.href.indexOf('sort_by=price-ascending') > -1 ) {
                 $(".shadowSort__option").removeClass("active");
                 $(".shadowSort__option[data-value='price-ascending']").addClass("active");
                  $("#sort-options-dropdown-title-bottom>span").text("Price, low to high");
               }
               if ( document.location.href.indexOf('sort_by=price-descending') > -1 ) {
                 $(".shadowSort__option").removeClass("active");
                 $(".shadowSort__option[data-value='price-descending']").addClass("active");
                 $("#sort-options-dropdown-title-bottom>span").text("Price, high to low");
               }
               if ( document.location.href.indexOf('sort_by=created-ascending') > -1 ) {
                 $(".shadowSort__option").removeClass("active");
                 $(".shadowSort__option[data-value='created-ascending']").addClass("active");
                  $("#sort-options-dropdown-title-bottom>span").text("Date, old to new");
               }
               if ( document.location.href.indexOf('sort_by=created-descending') > -1 ) {
                 $(".shadowSort__option").removeClass("active");
                 $(".shadowSort__option[data-value='created-descending']").addClass("active");
                 $("#sort-options-dropdown-title-bottom>span").text("Date, new to old");
               }
           });
           $(function() {
             if ( document.location.href.indexOf('?filter') > -1 ) {
               $(".active-filters__clear.clear-all-btn").show();
               $(".selected-filters-options-mobile").show();
             }
           });
           // $(function() {
           //   if ( document.location.href.indexOf('#grid3') > -1 ) {
           //      $('.display__3__items').addClass('display__active').siblings().removeClass('display__active');
           //      $('.display__3__items').closest('.collection-grid__wrapper').find('.collection__grid').addClass('collection__grid--3');
           //   }
           // });
         });


  //     $(".display__3__items").click(function(){
  //      $(".collection-grid__wrapper .collection__grid").removeClass("collection__grid--4");
  //       $(".collection-grid__wrapper .collection__grid").addClass("collection__grid--3");
  //       // $(this).addClass('display__active');
  //       $('.collection__grid--4, .collection__grid--4').toggleClass('display__active');
  //      // $(this).addClass("working");
  //      localStorage.ClassName = "collection__grid--3";
  //       // localStorage.ClassName2 = "display__active";
  //    });
  // $(".display__4__items").click(function(){
  //      $(".collection-grid__wrapper .collection__grid").removeClass("collection__grid--3");
  //       $(".collection-grid__wrapper .collection__grid").addClass("collection__grid--4");
  //       // $(this).addClass('display__active');
  //       // $('.collection__grid--3').removeClass('display__active');
  //      // $(this).addClass("working");
  //      localStorage.ClassName3 = "collection__grid--3";
  //       // localStorage.ClassName4 = "display__active";
  //    });

  //  $(document).ready(function() {
  //      SetClass();
  //  });

  //  function SetClass() {
  //  //before assigning class check local storage if it has any value
  //      $(".collection-grid__wrapper .collection__grid").addClass(localStorage.ClassName);
  //    $(".display__3__items, .collection__grid--4").toggleClass(localStorage.ClassName2);
  //     $(".collection-grid__wrapper .collection__grid").addClass3(localStorage.ClassName);
  //    $(".display__3__items").addClass(localStorage.ClassName4);
  //  }
</script>
<style>
          .sort-options .sort-options-dropdown-content>a.active span {
            background: #F9C8D3;
        }
        .active-filters__clear.clear-all-btn{
          display:none;
        }

      label.filter_Colour {
          padding: 0 !important;
      }
      .filter_Colour span:before{
          display:none;
      }
      span.color-box {
        margin-right: 9px;
    }
    .filter-sidebar .filter-group .options-list>li>label span {
      line-height: 17px !important;
  }
   label.filter_Colour {
      margin-bottom: 12px;
      display: flex !important;
  }
</style>

{% schema %}
{
  "name": "t:sections.main-collection-product-grid.name",
  "class": "section",
  "settings": [
    {
      "type": "range",
      "id": "per_page_product",
      "min": 12,
      "max": 32,
      "step": 4,
      "label": "Per page Product show",
      "default": 12
    }
  ]
}
{% endschema %}
